<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Practice multiplication tables with fun games">
    <meta name="theme-color" content="#4CAF50">
    <title>Multiplication Practice</title>

    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Install Banner -->
        <div id="install-banner" class="install-banner hidden">
            <div class="install-banner-content">
                <span class="install-banner-text">Install the app to keep your data safe!</span>
                <div class="install-banner-actions">
                    <button type="button" class="install-banner-btn" onclick="app.installPWA()">Install</button>
                    <button type="button" class="install-banner-dismiss" onclick="app.dismissInstallBanner()">&times;</button>
                </div>
            </div>
        </div>

        <!-- Menu Screen -->
        <div id="menu-screen" class="screen active">
            <div class="header">
                <h1>üéØ Multiplication Practice</h1>
                <p class="subtitle">Choose a practice mode!</p>
                <div class="profile-indicator" onclick="app.showProfileManager()">
                    <span class="icon">üë§</span>
                    <span id="current-profile-name">Anonyme</span>
                </div>
            </div>

            <div class="menu-buttons">
                <button class="mode-btn quiz-btn" onclick="app.startMode('quiz')">
                    <span class="icon">üìù</span>
                    <span class="label">Quiz Mode</span>
                    <span class="description">Random questions</span>
                </button>

                <button class="mode-btn timed-btn" onclick="app.startMode('timed')">
                    <span class="icon">‚è±Ô∏è</span>
                    <span class="label">Timed Challenge</span>
                    <span class="description">Race the clock!</span>
                </button>

                <button class="mode-btn practice-btn" onclick="app.showTableSelection()">
                    <span class="icon">üéì</span>
                    <span class="label">Practice by Table</span>
                    <span class="description">Focus on one table</span>
                </button>
            </div>

            <div class="bottom-buttons">
                <button class="secondary-btn" onclick="app.showStats()">
                    <span class="icon">üìä</span> View Stats
                </button>
                <button class="secondary-btn" onclick="app.showSettings()">
                    <span class="icon">‚öôÔ∏è</span> Settings
                </button>
                <button class="secondary-btn" onclick="app.showAbout()">
                    <span class="icon">‚ÑπÔ∏è</span> About
                </button>
            </div>

            <div class="language-selector">
                <button type="button" class="lang-btn active" id="lang-fr" onclick="app.setLanguage('fr')">üá´üá∑ Fran√ßais</button>
                <button type="button" class="lang-btn" id="lang-en" onclick="app.setLanguage('en')">üá¨üáß English</button>
            </div>
        </div>

        <!-- Settings Screen -->
        <div id="settings-screen" class="screen">
            <div class="header">
                <h2>‚öôÔ∏è Settings</h2>
                <p class="subtitle">Choose which tables to practice</p>
            </div>

            <div class="settings-content">
                <div class="table-selection">
                    <div class="select-all-row">
                        <button class="secondary-btn small" onclick="app.selectAllTables()">Select All</button>
                        <button class="secondary-btn small" onclick="app.deselectAllTables()">Deselect All</button>
                    </div>
                    <div class="table-grid" id="table-checkboxes">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <div class="settings-option">
                    <label class="toggle-label">
                        <span class="toggle-text">Show tips in Quiz mode</span>
                        <input type="checkbox" id="quiz-tips-toggle" checked onchange="app.toggleQuizTips()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <button class="back-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
        </div>

        <!-- Table Selection Screen (for Practice by Table mode) -->
        <div id="table-select-screen" class="screen">
            <div class="header">
                <h2>üéì Practice by Table</h2>
                <p class="subtitle">Choose a table to practice</p>
            </div>

            <div class="operation-toggle">
                <div class="operation-buttons">
                    <button type="button" class="operation-btn active" data-op="multiplication" onclick="app.toggleOperation('multiplication')">
                        <span class="op-icon">√ó</span>
                        <span class="op-label">Multiplication</span>
                    </button>
                    <button type="button" class="operation-btn" data-op="division" onclick="app.toggleOperation('division')">
                        <span class="op-icon">√∑</span>
                        <span class="op-label">Division</span>
                    </button>
                </div>
            </div>

            <div class="table-buttons-grid" id="practice-table-buttons">
                <!-- Generated by JS -->
            </div>

            <button class="back-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
        </div>

        <!-- Quiz Count Selection Screen -->
        <div id="quiz-count-screen" class="screen">
            <div class="header">
                <h2>üìù Quiz Mode</h2>
                <p class="subtitle">How many questions?</p>
            </div>

            <div class="operation-toggle">
                <div class="operation-buttons">
                    <button type="button" class="operation-btn active" data-op="multiplication" onclick="app.toggleOperation('multiplication')">
                        <span class="op-icon">√ó</span>
                        <span class="op-label">Multiplication</span>
                    </button>
                    <button type="button" class="operation-btn" data-op="division" onclick="app.toggleOperation('division')">
                        <span class="op-icon">√∑</span>
                        <span class="op-label">Division</span>
                    </button>
                </div>
            </div>

            <div class="quiz-count-buttons">
                <button class="quiz-count-btn" onclick="app.startQuizWithCount(20)">
                    <span class="count-number">20</span>
                    <span class="count-label">Questions</span>
                </button>
                <button class="quiz-count-btn" onclick="app.startQuizWithCount(50)">
                    <span class="count-number">50</span>
                    <span class="count-label">Questions</span>
                </button>
                <button class="quiz-count-btn" onclick="app.startQuizWithCount(100)">
                    <span class="count-number">100</span>
                    <span class="count-label">Questions</span>
                </button>
            </div>

            <button class="back-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
        </div>

        <!-- Timed Challenge Config Screen -->
        <div id="timed-config-screen" class="screen">
            <div class="header">
                <h2>‚è±Ô∏è Timed Challenge</h2>
                <p class="subtitle">60 seconds - answer as many as you can!</p>
            </div>

            <div class="operation-toggle">
                <div class="operation-buttons">
                    <button type="button" class="operation-btn active" data-op="multiplication" onclick="app.toggleOperation('multiplication')">
                        <span class="op-icon">√ó</span>
                        <span class="op-label">Multiplication</span>
                    </button>
                    <button type="button" class="operation-btn" data-op="division" onclick="app.toggleOperation('division')">
                        <span class="op-icon">√∑</span>
                        <span class="op-label">Division</span>
                    </button>
                </div>
            </div>

            <button class="primary-btn" onclick="app.startTimedFromConfig()">Start!</button>
            <button class="back-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
        </div>

        <!-- Quiz Mode Screen -->
        <div id="quiz-screen" class="screen game-screen">
            <div class="game-header">
                <button class="icon-btn" onclick="app.exitGame()">‚úï</button>
                <div class="progress-display">
                    <span id="quiz-progress">0/20</span>
                </div>
                <div class="score">Score: <span id="quiz-score">0</span></div>
            </div>

            <div class="question-container">
                <div class="question" id="quiz-question"></div>
                <input type="number" inputmode="numeric" id="quiz-answer" class="answer-input" placeholder="?" autocomplete="off">
                <button type="button" class="tip-btn hidden" id="quiz-tip-btn" onclick="app.showTip('quiz')">
                    <span class="tip-btn-label">Astuce</span>
                </button>
                <div class="tip-display hidden" id="quiz-tip-display"></div>
                <div class="feedback" id="quiz-feedback"></div>
            </div>

            <button class="submit-btn" id="quiz-submit" onclick="app.submitAnswer('quiz')">Check Answer</button>
            <button class="next-btn hidden" id="quiz-next" onclick="app.nextQuestion('quiz')">Next Question ‚Üí</button>
        </div>

        <!-- Timed Challenge Screen -->
        <div id="timed-screen" class="screen game-screen">
            <div class="game-header">
                <button class="icon-btn" onclick="app.exitGame()">‚úï</button>
                <div class="timer-display">
                    <span class="icon">‚è±Ô∏è</span>
                    <span id="timer">60</span>s
                </div>
                <div class="score">Score: <span id="timed-score">0</span></div>
            </div>

            <div class="question-container">
                <div class="question" id="timed-question"></div>
                <input type="number" inputmode="numeric" id="timed-answer" class="answer-input" placeholder="?" autocomplete="off">
                <button type="button" class="tip-btn hidden" id="timed-tip-btn" onclick="app.showTip('timed')">
                    <span class="tip-btn-label">Astuce</span>
                </button>
                <div class="tip-display hidden" id="timed-tip-display"></div>
                <div class="feedback" id="timed-feedback"></div>
            </div>

            <button class="submit-btn" id="timed-submit" onclick="app.submitAnswer('timed')">Check Answer</button>
        </div>

        <!-- Timed Results Screen -->
        <div id="timed-results-screen" class="screen">
            <div class="header">
                <h2>‚è±Ô∏è Time's Up!</h2>
            </div>

            <div class="results-content">
                <div class="big-score" id="final-score">0</div>
                <p class="results-label">Questions Answered</p>

                <div class="encouragement" id="encouragement-message">Great job!</div>

                <div class="high-score-container">
                    <p>High Score: <strong id="high-score">0</strong></p>
                </div>
            </div>

            <div class="bottom-buttons">
                <button class="primary-btn" onclick="app.startMode('timed')">Play Again</button>
                <button class="secondary-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
            </div>
        </div>

        <!-- Quiz Results Screen -->
        <div id="quiz-results-screen" class="screen">
            <div class="header">
                <h2>üéØ Quiz Complete!</h2>
            </div>

            <div class="results-content">
                <div class="big-score" id="quiz-final-score">0/20</div>
                <p class="results-label">Correct Answers</p>

                <div class="encouragement" id="quiz-encouragement">Great job!</div>

                <div class="quiz-time-stats">
                    <div class="time-stat">
                        <span class="time-stat-value" id="quiz-time-display">0s</span>
                        <span class="time-stat-label">Total Time</span>
                    </div>
                    <div class="time-stat">
                        <span class="time-stat-value" id="quiz-avg-time">0s</span>
                        <span class="time-stat-label">Avg per Question</span>
                    </div>
                </div>
            </div>

            <div class="bottom-buttons">
                <button class="primary-btn" onclick="app.startMode('quiz')">Play Again</button>
                <button class="secondary-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
            </div>
        </div>

        <!-- Practice by Table Screen -->
        <div id="practice-screen" class="screen game-screen">
            <div class="game-header">
                <button class="icon-btn" onclick="app.exitGame()">‚úï</button>
                <div class="progress-display">
                    <span id="practice-progress"></span>
                </div>
                <div class="table-label">Table: <span id="practice-table"></span></div>
            </div>

            <div class="question-container">
                <div class="question" id="practice-question"></div>
                <input type="number" inputmode="numeric" id="practice-answer" class="answer-input" placeholder="?" autocomplete="off">
                <button type="button" class="tip-btn hidden" id="practice-tip-btn" onclick="app.showTip('practice')">
                    <span class="tip-btn-label">Astuce</span>
                </button>
                <div class="tip-display hidden" id="practice-tip-display"></div>
                <div class="feedback" id="practice-feedback"></div>
            </div>

            <button class="submit-btn" id="practice-submit" onclick="app.submitAnswer('practice')">Check Answer</button>
            <button class="next-btn hidden" id="practice-next" onclick="app.nextQuestion('practice')">Next Question ‚Üí</button>
        </div>

        <!-- Practice Results Screen -->
        <div id="practice-results-screen" class="screen">
            <div class="header">
                <h2>üéì Practice Complete!</h2>
            </div>

            <div class="results-content">
                <p class="results-label">Table <strong id="completed-table">7</strong></p>
                <div class="big-score" id="practice-final-score">10/12</div>
                <p class="results-label">Correct Answers</p>

                <div class="encouragement" id="practice-encouragement">Excellent work!</div>
            </div>

            <div class="bottom-buttons">
                <button class="primary-btn" onclick="app.showTableSelection()">Practice Another Table</button>
                <button class="secondary-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
            </div>
        </div>

        <!-- About Screen -->
        <div id="about-screen" class="screen">
            <div class="header">
                <h2>‚ÑπÔ∏è About</h2>
            </div>

            <div class="about-content">
                <p id="about-text"></p>
            </div>

            <button class="back-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
        </div>

        <!-- Stats Screen -->
        <div id="stats-screen" class="screen">
            <div class="header">
                <h2>üìä Your Progress</h2>
            </div>

            <div class="stats-tabs">
                <button type="button" class="stats-tab" data-period="day" onclick="app.filterStats('day')">Jour</button>
                <button type="button" class="stats-tab" data-period="week" onclick="app.filterStats('week')">Semaine</button>
                <button type="button" class="stats-tab" data-period="month" onclick="app.filterStats('month')">Mois</button>
                <button type="button" class="stats-tab active" data-period="all" onclick="app.filterStats('all')">Tout</button>
            </div>

            <div class="stats-content">
                <div class="stat-card">
                    <div class="stat-value" id="total-questions">0</div>
                    <div class="stat-label">Total Questions</div>
                </div>

                <div class="stat-card">
                    <div class="stat-value" id="total-correct">0</div>
                    <div class="stat-label">Correct Answers</div>
                </div>

                <div class="stat-card">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">Accuracy</div>
                </div>

                <div class="stat-card">
                    <div class="stat-value" id="timed-high-score">0</div>
                    <div class="stat-label">Timed High Score</div>
                </div>

                <div class="stat-card">
                    <div class="stat-value" id="tip-usage-count">0</div>
                    <div class="stat-label">Tips Used</div>
                </div>

                <div class="table-stats-container">
                    <h3>Stats by Table</h3>
                    <div id="table-stats" class="table-stats">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <div class="progress-section" id="progress-section">
                    <h3>Progress</h3>
                    <div id="progress-content">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <button class="danger-btn small" onclick="app.resetStats()">Reset All Stats</button>
            </div>

            <button class="back-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
        </div>

        <!-- Profiles Screen -->
        <div id="profiles-screen" class="screen">
            <div class="header">
                <h2>üë§ Profile Management</h2>
                <p class="subtitle">Create and manage user profiles</p>
            </div>

            <div class="profiles-content">
                <button class="primary-btn" onclick="app.showCreateProfileDialog()">Create New Profile</button>

                <div class="data-management-section">
                    <h3>Data Management</h3>
                    <div class="data-buttons">
                        <button type="button" class="secondary-btn" onclick="app.exportProfiles()">
                            <span class="icon">üì§</span> <span class="export-label">Export Data</span>
                        </button>
                        <button type="button" class="secondary-btn" onclick="app.triggerImport()">
                            <span class="icon">üì•</span> <span class="import-label">Import Data</span>
                        </button>
                    </div>
                    <input type="file" id="import-file-input" accept=".json" class="hidden" aria-label="Import data file" onchange="app.importProfiles(event)">
                </div>

                <div class="profile-list" id="profile-list">
                    <!-- Generated by JS -->
                </div>
            </div>

            <button class="back-btn" onclick="app.showMenu()">‚Üê Back to Menu</button>
        </div>
    </div>

    <!-- Create Profile Modal -->
    <div id="create-profile-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="modal-title">Create New Profile</h3>
            <input type="text" id="profile-name-input" class="profile-input" placeholder="Enter name..." autocomplete="off">
            <div class="modal-buttons">
                <button class="primary-btn" onclick="app.confirmCreateProfile()">Create</button>
                <button class="secondary-btn" onclick="app.cancelCreateProfile()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Confetti Container for Animations -->
    <div id="confetti-container"></div>

    <!-- Scripts -->
    <script src="app.js"></script>
    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }
    </script>
</body>
</html>
